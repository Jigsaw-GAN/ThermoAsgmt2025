import{d as v,r as _,O as A,L as C,z as d,E as k,f as E,o as I,j as b}from"../modules/vue-D4XdBjkl.js";import{a9 as x,N,aa as K,ab as q,ac as B}from"../index-CY2W6Yfx.js";import{u as M}from"./context-Cc6rS5o-.js";const w=v({__name:"KaTexBlockWrapper",props:{ranges:{type:Array,default:()=>[]},finally:{type:[String,Number],default:"last"},startLine:{type:Number,default:1},at:{type:[String,Number],default:"+1"}},setup(y){const e=y,{$clicksContext:a}=M(),o=_(),f=x();return A(()=>{a.unregister(f)}),C(()=>{if(!a||!e.ranges?.length)return;const s=a.calculateSince(e.at,e.ranges.length-1);a.register(f,s);const c=d(()=>s?Math.max(0,a.current-s.start+1):N),g=d(()=>e.finally==="last"?e.ranges.at(-1):e.finally.toString());k(()=>{if(!o.value)return;let i=e.ranges[c.value]??g.value;const p=i==="hide";o.value.classList.toggle(K,p),p&&(i=e.ranges[c.value+1]??g.value);const h=o.value.querySelectorAll(".mtable > [class*=col-align]");if(!h)return;const S=Array.from(h).map(n=>Array.from(n.querySelectorAll(":scope > .vlist-t > .vlist-r > .vlist > span > .mord"))),r=[];for(const n of S)n.forEach((l,t)=>{l&&(Array.isArray(r[t])?r[t].push(l):r[t]=[l])});const m=e.startLine,L=q(r.length+m-1,i);r.forEach((n,l)=>{const t=L.includes(l+m);n.forEach(u=>{u.classList.toggle(B,!0),u.classList.toggle("highlighted",t),u.classList.toggle("dishonored",!t)})})})}),(s,c)=>(I(),E("div",{ref_key:"el",ref:o,class:"slidev-katex-wrapper"},[b(s.$slots,"default")],512))}});export{w as _};
